<template>
  <section>
    <transition name="dialog" mode="out-in">
      <logout-alert
        v-if="showLogoutAlert"
        @confirm="handleLogout"
        @cancel="showLogoutAlert = false" />
    </transition>

    <div id="nav">
      <div class="nav-content">
        <nav>
          <router-link 
            @click.native="nextPage"
            :to="{ name: 'home' }" exact>
            <svg width="38" height="41" viewBox="0 0 38 41" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path class="background" d="M36.2146 21.0563C36.2146 18.7716 36.2146 16.7726 36.3174 15.2305L18.9542 1.41992L1.60254 16.4299V39.6074H33.8728C34.5284 39.5984 35.1542 39.3325 35.6157 38.8667C36.0771 38.401 36.3373 37.7728 36.3402 37.1171V21.7988C36.3347 21.5465 36.2924 21.2963 36.2146 21.0563Z" fill="#77B3C4"/>
              <path fill-rule="evenodd" clip-rule="evenodd" d="M18.3931 0.77129C18.7048 0.501644 19.1643 0.492168 19.4869 0.748734L36.85 14.5593C37.0544 14.7218 37.1734 14.9687 37.1734 15.2298V26.4016C37.1734 26.8747 36.7899 27.2583 36.3167 27.2583C35.8435 27.2583 35.46 26.8747 35.46 26.4016V15.643L18.9765 2.53218L2.45858 16.8209V38.75H22.0721C22.5452 38.75 22.9288 39.1335 22.9288 39.6067C22.9288 40.0799 22.5452 40.4634 22.0721 40.4634H1.60185C1.12869 40.4634 0.745117 40.0799 0.745117 39.6067V16.4292C0.745117 16.1805 0.853226 15.944 1.04135 15.7813L18.3931 0.77129Z" fill="white"/>
              <path fill-rule="evenodd" clip-rule="evenodd" d="M14.4072 26.4017C14.4072 25.9285 14.7908 25.5449 15.264 25.5449H22.6433C23.1165 25.5449 23.5 25.9285 23.5 26.4017V39.6068C23.5 40.0799 23.1165 40.4635 22.6433 40.4635H15.264C14.7908 40.4635 14.4072 40.0799 14.4072 39.6068V26.4017ZM16.1207 27.2584V38.75H21.7866V27.2584H16.1207Z" fill="white"/>
            </svg>
            <p>Home</p>
          </router-link>

          <template v-if="user && user.emailVerified">
            <router-link 
              @click.native="nextPage"
              :to="{ name: 'visa-info' }">
              <svg width="30" height="42" viewBox="0 0 30 42" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path class="background" d="M28.7994 17.5227C28.7994 22.092 27.16 28.5117 28.7994 37.1134C28.8604 37.9807 28.5484 38.8352 27.9318 39.4902C27.3151 40.1451 26.4438 40.5473 25.5082 40.6088H1.10156V1.77024C3.20941 1.09628 16.67 1.77024 25.5082 1.77024C26.3598 1.78939 27.1722 2.10608 27.7826 2.65686C28.3929 3.20763 28.7561 3.9518 28.7994 4.74025V17.5227Z" fill="#77B3C4"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M14.9416 8.43026C11.1851 8.43026 8.13339 11.4901 8.13339 15.2727C8.13339 19.0553 11.1851 22.1152 14.9416 22.1152C18.698 22.1152 21.7497 19.0553 21.7497 15.2727C21.7497 11.4901 18.698 8.43026 14.9416 8.43026ZM6.41992 15.2727C6.41992 10.551 10.2316 6.7168 14.9416 6.7168C19.6515 6.7168 23.4632 10.551 23.4632 15.2727C23.4632 19.9944 19.6515 23.8286 14.9416 23.8286C10.2316 23.8286 6.41992 19.9944 6.41992 15.2727Z" fill="white"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M6.40723 30.3274C6.40723 29.8543 6.7908 29.4707 7.26396 29.4707H22.6052C23.0784 29.4707 23.4619 29.8543 23.4619 30.3274C23.4619 30.8006 23.0784 31.1842 22.6052 31.1842H7.26396C6.7908 31.1842 6.40723 30.8006 6.40723 30.3274Z" fill="white"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M6.40723 33.6849C6.40723 33.2117 6.7908 32.8281 7.26396 32.8281H16.7908C17.264 32.8281 17.6476 33.2117 17.6476 33.6849C17.6476 34.158 17.264 34.5416 16.7908 34.5416H7.26396C6.7908 34.5416 6.40723 34.158 6.40723 33.6849Z" fill="white"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M0.245117 1.76884C0.245117 1.29568 0.656557 0.912109 1.16409 0.912109H25.425C25.9326 0.912109 26.344 1.29568 26.344 1.76884C26.344 2.242 25.9326 2.62558 25.425 2.62558H2.08307V39.7507H25.39C26.0664 39.6986 26.695 39.4028 27.1417 38.9255C27.5951 38.4411 27.8244 37.8092 27.7796 37.1677C27.7783 37.1491 27.7776 37.1305 27.7776 37.112V17.5213C27.7776 17.0482 28.1891 16.6646 28.6966 16.6646C29.2041 16.6646 29.6156 17.0482 29.6156 17.5213V37.0857C29.683 38.1688 29.2923 39.2339 28.5266 40.052C27.754 40.8775 26.6623 41.3844 25.4901 41.462C25.4685 41.4634 25.4468 41.4642 25.425 41.4642H1.16409C0.656557 41.4642 0.245117 41.0806 0.245117 40.6074V1.76884Z" fill="white"/>
              </svg>
              <p>Visas</p>
            </router-link>
          </template>

          <router-link 
            @click.native="nextPage"
            :to="{ name: 'about' }">
            <svg width="42" height="43" viewBox="0 0 42 43" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path class="background" d="M20.8634 40.8226C31.8218 40.8226 40.7054 31.939 40.7054 20.9806C40.7054 10.0222 31.8218 1.13867 20.8634 1.13867C9.90502 1.13867 1.02148 10.0222 1.02148 20.9806C1.02148 31.939 9.90502 40.8226 20.8634 40.8226Z" fill="#77B3C4"/>
              <path fill-rule="evenodd" clip-rule="evenodd" d="M21.0001 0.912653C23.6817 0.893084 26.341 1.4021 28.8258 2.41063C31.3107 3.41916 33.5725 4.90742 35.482 6.79039C37.3915 8.67335 38.9112 10.9141 39.9544 13.3846C40.9976 15.8551 41.5437 18.507 41.5617 21.1887C41.5437 23.8703 40.9976 26.5222 39.9544 28.9927C38.9112 31.4632 37.3915 33.704 35.482 35.587C33.5725 37.4699 31.3107 38.9582 28.8258 39.9667C26.341 40.9753 23.6817 41.4843 21.0001 41.4647C18.3184 41.4843 15.6592 40.9753 13.1743 39.9667C10.6894 38.9582 8.42765 37.4699 6.51817 35.587C4.60868 33.704 3.08893 31.4632 2.04575 28.9927C1.00258 26.5222 0.456413 23.8703 0.438477 21.1887C0.456413 18.507 1.00258 15.8551 2.04575 13.3846C3.08893 10.9141 4.60868 8.67335 6.51817 6.79039C8.42765 4.90742 10.6894 3.41916 13.1743 2.41063C15.6592 1.4021 18.3184 0.893084 21.0001 0.912653ZM21.0001 2.28343C26.0436 2.25908 30.8911 4.23543 34.4799 7.77925C38.0687 11.3231 40.106 16.1452 40.1452 21.1887C40.106 26.2321 38.0687 31.0543 34.4799 34.5981C30.8911 38.1419 26.0436 40.1183 21.0001 40.0939C15.9486 40.1304 11.0894 38.1595 7.49076 34.6143C3.89208 31.0692 1.84849 26.2401 1.80925 21.1887C1.84849 16.1373 3.89208 11.3082 7.49076 7.76303C11.0894 4.2179 15.9486 2.24693 21.0001 2.28343Z" fill="white"/>
              <path fill-rule="evenodd" clip-rule="evenodd" d="M22.1426 19.1876C22.1426 19.1876 27.4772 17.8168 31.738 20.8896C32.9781 21.7671 34.0042 22.913 34.74 24.2421C35.4757 25.5712 35.9021 27.0492 35.9874 28.5659C32.7967 28.4836 29.6686 27.6625 26.8489 26.1671C23.3991 24.1224 22.1426 19.1876 22.1426 19.1876Z" fill="white"/>
              <path fill-rule="evenodd" clip-rule="evenodd" d="M5.00851 8.46254C4.40596 9.18086 3.85983 9.94468 3.375 10.7472C4.48169 10.2026 5.62713 9.74063 6.80193 9.36497C8.23718 8.84326 9.77429 8.66335 11.2912 8.8395C14.4097 9.42208 17.0028 11.1241 20.5439 19.4059C21.5927 21.9587 23.2843 24.1967 25.4541 25.9021C27.624 27.6076 30.1982 28.7225 32.9266 29.1384C35.3821 29.4512 37.8768 29.1731 40.2031 28.3273C40.4288 27.748 40.6233 27.1569 40.7857 26.5567C38.4012 27.6235 35.7705 28.0185 33.1779 27.6991C30.6922 27.3195 28.3469 26.3039 26.3694 24.7508C24.392 23.1976 22.8496 21.1597 21.8919 18.8347C17.9852 9.78762 14.9809 8.05131 11.6111 7.41161C9.86985 7.19679 8.10254 7.38838 6.44782 7.97135C5.92235 8.13127 5.45401 8.30262 5.00851 8.46254Z" fill="white"/>
              <path fill-rule="evenodd" clip-rule="evenodd" d="M35.976 31.5257C35.9438 31.7063 35.8448 31.8682 35.6988 31.9792C35.5527 32.0903 35.3702 32.1423 35.1875 32.1251C35.0049 32.1078 34.8354 32.0225 34.7127 31.8861C34.59 31.7496 34.5231 31.572 34.5253 31.3886C34.6389 30.0365 34.5968 28.6758 34.3996 27.3334C34.3135 26.7781 34.1441 26.2389 33.897 25.7341C33.7537 25.414 33.4975 25.1578 33.1774 25.0145C33.0871 24.9848 33.0037 24.9376 32.9318 24.8755C32.8599 24.8134 32.8011 24.7377 32.7586 24.6527C32.7161 24.5678 32.6909 24.4752 32.6843 24.3805C32.6778 24.2857 32.6901 24.1906 32.7204 24.1006C32.7875 23.9188 32.9231 23.7704 33.0981 23.6872C33.2731 23.604 33.4737 23.5925 33.6571 23.6551C34.1424 23.8755 34.5696 24.2061 34.9047 24.6206C35.2398 25.035 35.4737 25.5219 35.5876 26.0426C36.0113 27.8375 36.1425 29.689 35.976 31.5257Z" fill="white"/>
              <path fill-rule="evenodd" clip-rule="evenodd" d="M21.0001 40.0353C31.2514 40.0353 39.5617 31.725 39.5617 21.4737C39.5617 11.2224 31.2514 2.91211 21.0001 2.91211C10.7488 2.91211 2.43848 11.2224 2.43848 21.4737C2.43848 31.725 10.7488 40.0353 21.0001 40.0353ZM21.0001 42.0353C32.3559 42.0353 41.5617 32.8296 41.5617 21.4737C41.5617 10.1179 32.3559 0.912109 21.0001 0.912109C9.64422 0.912109 0.438477 10.1179 0.438477 21.4737C0.438477 32.8296 9.64422 42.0353 21.0001 42.0353Z" fill="white"/>
            </svg>
            <p>About</p>
          </router-link>

          <template v-if="user && user.emailVerified">
            <router-link 
              @click.native="nextPage"
              :to="{ name: 'profile', params: { username: user.profile.username } }">
              <svg width="34" height="42" viewBox="0 0 34 42" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path class="background" d="M22.6023 21.5944C26.8907 18.6227 27.9582 12.7373 24.9865 8.44887C22.0149 4.16046 16.1294 3.09302 11.841 6.06467C7.55261 9.03632 6.48517 14.9218 9.45682 19.2102C12.4285 23.4986 18.3139 24.566 22.6023 21.5944Z" fill="#77B3C4"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M19.1846 5.49867C17.5319 5.11108 15.8014 5.22252 14.212 5.81888C12.6227 6.41523 11.246 7.46969 10.2563 8.8488C9.26648 10.2279 8.70809 11.8697 8.65178 13.5662C8.59547 15.2628 9.04377 16.938 9.93992 18.3797C10.8361 19.8214 12.1398 20.9648 13.6861 21.6653C15.2324 22.3657 16.9517 22.5916 18.6264 22.3145C20.3012 22.0373 21.8561 21.2695 23.0943 20.1083C24.3325 18.9471 25.1983 17.4446 25.5823 15.7911C25.6893 15.3302 26.1497 15.0433 26.6106 15.1503C27.0715 15.2574 27.3584 15.7177 27.2513 16.1786C26.7907 18.1624 25.7519 19.965 24.2664 21.3582C22.7809 22.7513 20.9154 23.6724 18.9062 24.0049C16.8969 24.3374 14.8342 24.0664 12.9791 23.2261C11.1239 22.3857 9.55982 21.0139 8.48468 19.2843C7.40953 17.5546 6.8717 15.5449 6.93926 13.5094C7.00682 11.4739 7.67673 9.50429 8.8642 7.84973C10.0517 6.19517 11.7033 4.93009 13.6101 4.21463C15.5168 3.49916 17.593 3.36546 19.5758 3.83046C20.0365 3.9385 20.3223 4.39952 20.2143 4.86018C20.1062 5.32084 19.6452 5.6067 19.1846 5.49867Z" fill="white"/>
                <path class="background" d="M22.4537 25.82C18.9958 25.2163 15.4594 25.2163 12.0015 25.82C9.27487 25.82 6.6599 26.9031 4.73188 28.8312C2.80386 30.7592 1.7207 33.3741 1.7207 36.1008V38.6824C1.7207 39.2883 1.9614 39.8694 2.38985 40.2979C2.8183 40.7263 3.39941 40.967 4.00533 40.967H30.3927C30.9986 40.967 31.5797 40.7263 32.0082 40.2979C32.4366 39.8694 32.6773 39.2883 32.6773 38.6824C32.7586 37.8238 32.7586 36.9594 32.6773 36.1008C32.586 35.2555 32.1861 31.1203 29.2504 28.4245C27.457 26.7224 25.4808 26.3683 22.4537 25.82Z" fill="#77B3C4"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M4.12637 28.225C6.21506 26.1363 9.04793 24.9629 12.0018 24.9629H22.4539C22.9271 24.9629 23.3107 25.3465 23.3107 25.8196C23.3107 26.2928 22.9271 26.6764 22.4539 26.6764H12.0018C9.50237 26.6764 7.10533 27.6692 5.33797 29.4366C3.57061 31.204 2.57772 33.601 2.57772 36.1004V38.682C2.57772 39.0607 2.72816 39.4239 2.99594 39.6917C3.26372 39.9595 3.62691 40.1099 4.00561 40.1099H30.393C30.7717 40.1099 31.1349 39.9595 31.4027 39.6917C31.6705 39.4239 31.8209 39.0607 31.8209 38.682V36.089C31.8209 35.6158 32.2045 35.2323 32.6776 35.2323C33.1508 35.2323 33.5344 35.6158 33.5344 36.089V38.682C33.5344 39.5152 33.2034 40.3142 32.6143 40.9033C32.0252 41.4924 31.2261 41.8234 30.393 41.8234H4.00561C3.17248 41.8234 2.37346 41.4924 1.78434 40.9033C1.19522 40.3142 0.864258 39.5152 0.864258 38.682V36.1004C0.864258 33.1466 2.03767 30.3137 4.12637 28.225Z" fill="white"/>
              </svg>
              <p>Profile</p>
            </router-link>
          </template>

          <template v-if="user">
            <a @click="showLogoutAlert = true" class="sign-out">
              <svg width="42" height="33" viewBox="0 0 42 33" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path class="background" d="M26.1726 31.6245C34.4308 31.6245 41.1254 24.9298 41.1254 16.6716C41.1254 8.41337 34.4308 1.71875 26.1726 1.71875C17.9143 1.71875 11.2197 8.41337 11.2197 16.6716C11.2197 24.9298 17.9143 31.6245 26.1726 31.6245Z" fill="#77B3C4"/>
                <path d="M0.595843 15.3808L5.97613 10.5603C6.10686 10.435 6.26148 10.3373 6.43078 10.2731C6.60008 10.2089 6.78058 10.1795 6.9615 10.1866C7.14243 10.1937 7.32007 10.2371 7.48383 10.3144C7.64758 10.3916 7.7941 10.5011 7.91463 10.6362C8.03516 10.7713 8.12723 10.9293 8.18535 11.1008C8.24347 11.2723 8.26645 11.4537 8.25291 11.6343C8.23937 11.8148 8.18959 11.9908 8.10655 12.1517C8.0235 12.3126 7.90889 12.4551 7.76956 12.5707L4.71959 15.3237H29.4278C29.7624 15.3546 30.0734 15.5094 30.2998 15.7577C30.5262 16.006 30.6517 16.3299 30.6517 16.6659C30.6517 17.002 30.5262 17.3259 30.2998 17.5742C30.0734 17.8225 29.7624 17.9772 29.4278 18.0081H5.02801L7.82667 20.8182C7.95205 20.9434 8.05152 21.0921 8.11938 21.2558C8.18724 21.4194 8.22217 21.5949 8.22217 21.7721C8.22217 21.9492 8.18724 22.1247 8.11938 22.2884C8.05152 22.452 7.95205 22.6007 7.82667 22.7259C7.57431 22.9756 7.2336 23.1157 6.87855 23.1157C6.52351 23.1157 6.1828 22.9756 5.93044 22.7259L0.55015 17.3342C0.416292 17.2091 0.309566 17.0579 0.236598 16.8899C0.16363 16.7219 0.125977 16.5407 0.125977 16.3575C0.125977 16.1743 0.16363 15.9931 0.236598 15.8251C0.309566 15.6571 0.416292 15.5059 0.55015 15.3808H0.595843Z" fill="white"/>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M31.8271 3.77106C29.297 2.66014 26.4961 2.31796 23.773 2.78713C21.0499 3.2563 18.5249 4.51609 16.5125 6.40966C16.1679 6.7339 15.6257 6.71741 15.3015 6.37281C14.9772 6.02821 14.9937 5.48601 15.3383 5.16177C17.5955 3.03784 20.4277 1.62479 23.482 1.09854C26.5364 0.572292 29.6781 0.9561 32.5159 2.20218C35.3538 3.44825 37.7624 5.50155 39.442 8.10641C41.1215 10.7113 41.9977 13.7526 41.9615 16.8518C41.9253 19.9509 40.9783 22.971 39.2384 25.5359C37.4985 28.1009 35.0426 30.0974 32.1764 31.2768C29.3103 32.4563 26.1605 32.7666 23.1192 32.1692C20.078 31.5718 17.2796 30.093 15.0726 27.9169C14.7357 27.5847 14.7318 27.0423 15.0641 26.7053C15.3963 26.3684 15.9387 26.3646 16.2756 26.6968C18.2433 28.6368 20.7381 29.9552 23.4495 30.4879C26.1609 31.0205 28.9691 30.7438 31.5244 29.6923C34.0797 28.6407 36.2692 26.8608 37.8204 24.574C39.3716 22.2873 40.2159 19.5948 40.2482 16.8318C40.2804 14.0687 39.4992 11.3573 38.0019 9.03493C36.5045 6.71259 34.3571 4.88199 31.8271 3.77106Z" fill="white"/>
              </svg>
              <p>Sign Out</p>
            </a>
          </template>
        </nav>
      </div>
    </div>
  </section>
</template>

<script>
import logoutAlert from '@/components/alerts/logout/ConfirmLogout'

export default {
  data() {
    return {
      showLogoutAlert: false
    }
  },
  components: { logoutAlert },
  computed: {
    user() {
      return this.$store.state.auth.user;
    },
    isAuthenticated() {
      return this.$store.getters['auth/isAuthenticated'];
    }
  },
  methods: {
    nextPage() {
      setTimeout(() => {
        this.open = false;
      }, 300);
    },
    handleLogout() {
      this.showLogoutAlert = false

      setTimeout(() => {
        this.$store.dispatch('auth/logOut')
        .then(() => {
          this.$store. commit('auth/setLoggedOut')
          this.$store.commit('wave/setWaveAway', false)
          this.$store.commit('wave/setFullScreen', false)
          this.$store.dispatch('wave/handleTransition')

          if(this.$route.path !== '/') {
            this.$router.push('/')
          }
        })
      }, 800)
    }
  }
}
</script>

<style scoped lang="scss">
@import '@/assets/styles/variables.scss';

#nav {
  width: 100px;
  height: 100%;
  padding: 3rem 0;
  background: $blue;
  position: fixed;
  z-index: 20;
}

.nav-content {
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: space-between;
}

nav {
  position: relative;
  width: 100%;
  height: 100%;

  a {
    cursor: pointer;
    text-decoration: none;
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-bottom: 2rem;
  }

  p {
    font-size: 14px;
    font-weight: 600;
    color: $light-font;
    pointer-events: none;
  }

  svg {
    pointer-events: none;
  }

  .sign-out {
    width: 100%;
    position: absolute;
    bottom: 0;
    margin-bottom: 0;
  }
}

.logo {
  width: 50%;
}

.background {
  fill: none;
}

a.router-link-active {
  .background {
    fill: $secondary-blue;
  }
}
</style>
